(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{16:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a(1),i=a.n(c),o=a(7),s=a.n(o),r=(a(16),a(10)),l=a(4),u=a(2),d=a.p+"static/media/logo.a307e1c4.svg";var p=function(){return Object(n.jsx)("header",{className:"header",children:Object(n.jsx)("img",{className:"header__logo",src:d,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f"})})},j=i.a.createContext();var b=function(e){var t=e.card,a=e.onCardClick,c=e.onCardLike,o=e.onCardDelete,s=i.a.useContext(j),r=t.owner._id===s._id,l=t.likes.some((function(e){return e._id===s._id})),u="element__delete ".concat(r?"element__delete_visible":""),d="element__like ".concat(l?"element__like_liked":"");return Object(n.jsxs)("li",{className:"element",children:[Object(n.jsx)("button",{className:u,onClick:function(){o(t)},type:"button"}),Object(n.jsx)("img",{className:"element__image",src:t.link,alt:t.name,onClick:function(){a(t)}}),Object(n.jsxs)("div",{className:"element__sign",children:[Object(n.jsx)("h2",{className:"element__title",children:t.name}),Object(n.jsxs)("div",{className:"element__like-field",children:[Object(n.jsx)("button",{className:d,onClick:function(){c(t)},type:"button"}),Object(n.jsx)("p",{className:"element__like-number",children:t.likes.length})]})]})]})};var m=function(e){var t=e.onEditProfile,a=e.onAddPlace,c=e.onEditAvatar,o=e.onCardClick,s=e.cards,r=e.onCardLike,l=e.onCardDelete,u=i.a.useContext(j);return Object(n.jsxs)("main",{children:[Object(n.jsxs)("section",{className:"profile",children:[Object(n.jsxs)("div",{className:"profile__avatar-field",children:[Object(n.jsx)("img",{className:"profile__avatar",src:u.avatar,alt:"\u0424\u043e\u0442\u043e"}),Object(n.jsx)("button",{className:"profile__avatar-button",type:"button",onClick:c})]}),Object(n.jsxs)("div",{className:"profile__info",children:[Object(n.jsx)("h1",{className:"profile__name",children:u.name}),Object(n.jsx)("button",{className:"profile__info-button",type:"button",onClick:t}),Object(n.jsx)("p",{className:"profile__about",children:u.about})]}),Object(n.jsx)("button",{type:"button",className:"profile__add-button",onClick:a})]}),Object(n.jsx)("section",{className:"elements",children:Object(n.jsx)("ul",{className:"elements__table",children:s.map((function(e){return Object(n.jsx)(b,{card:e,onCardClick:o,onCardLike:r,onCardDelete:l},e._id)}))})})]})};var _=function(){return Object(n.jsx)("footer",{className:"footer",children:Object(n.jsx)("p",{className:"footer__author",children:"\xa9 2020 Mesto Russia"})})};var f=function(e){var t=e.card,a=e.onClose,c=e.onClickOverlay;return Object(n.jsx)("div",{className:"popup popup_image-open ".concat(t.isOpen?"popup_opened":""),onClick:c,children:Object(n.jsxs)("div",{className:"popup__image-container",children:[Object(n.jsx)("button",{className:"popup__close popup__close-image",type:"button",onClick:a}),Object(n.jsx)("img",{className:"popup__image",src:t.link,alt:t.name}),Object(n.jsx)("h3",{className:"popup__image-title",children:t.name})]})})};var O=function(e){var t=e.title,a=e.name,c=e.button,i=e.children,o=e.isOpen,s=e.onClose,r=e.onSubmit,l=e.onClickOverlay,u=e.isValid;return Object(n.jsx)("section",{className:"popup popup_".concat(a," ").concat(o?"popup_opened":""),onClick:l,children:Object(n.jsxs)("div",{className:"popup__container popup__container_".concat(a),children:[Object(n.jsx)("button",{className:"popup__close popup__close-".concat(a),type:"button",onClick:s}),Object(n.jsxs)("form",{className:"popup__field popup__field-".concat(a),name:"form".concat(a),method:"GET",onSubmit:r,noValidate:!0,children:[Object(n.jsx)("h3",{className:"popup__title",children:t}),i,Object(n.jsx)("button",{className:"popup__submit-button popup__submit-button_".concat(a," ").concat(u?"":"popup__button_inactive"),type:"submit",name:"submit",children:c})]})]})})};var h=function(e){var t=e.isOpen,a=e.onClose,c=e.onUpdateUser,o=e.onClickOverlay,s=i.a.useState(!1),r=Object(u.a)(s,2),l=r[0],d=r[1],p=i.a.useContext(j),b=i.a.useState(p.name),m=Object(u.a)(b,2),_=m[0],f=m[1],h=i.a.useState(p.about),v=Object(u.a)(h,2),C=v[0],k=v[1],x=i.a.useState(!0),g=Object(u.a)(x,2),y=g[0],N=g[1],S=i.a.useState(""),E=Object(u.a)(S,2),L=E[0],P=E[1],U=i.a.useState(!0),D=Object(u.a)(U,2),q=D[0],A=D[1],w=i.a.useState(""),T=Object(u.a)(w,2),I=T[0],R=T[1];return i.a.useEffect((function(){f(p.name),k(p.about),t&&(d(!1),N(!0),A(!0),P(""),R(""))}),[p,t]),Object(n.jsxs)(O,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"ElementProfile",button:l?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,isValid:q&&y,onClose:a,onSubmit:function(e){e.preventDefault(),d(!0),c({name:_,about:C})},onClickOverlay:o,children:[Object(n.jsx)("input",{type:"text",name:"name",className:"popup__input popup__field-name",id:"input-name",minLength:"2",maxLength:"40",value:_||"",onChange:function(e){N(e.target.validity.valid),P(e.target.validationMessage),f(e.target.value)},required:!0}),Object(n.jsx)("span",{className:"error ".concat(y?"":"error_active"),id:"input-name-error",children:L}),Object(n.jsx)("input",{type:"text",name:"job",className:"popup__input popup__field-about",id:"input-job",minLength:"2",maxLength:"400",value:C||"",onChange:function(e){A(e.target.validity.valid),R(e.target.validationMessage),k(e.target.value)},required:!0}),Object(n.jsx)("span",{className:"error ".concat(q?"":"error_active"),id:"input-job-error",children:I})]})};var v=function(e){var t=e.isOpen,a=e.onClose,c=e.onUpdateAvatar,o=e.onClickOverlay,s=i.a.useState(!1),r=Object(u.a)(s,2),l=r[0],d=r[1],p=i.a.useState(""),j=Object(u.a)(p,2),b=j[0],m=j[1],_=i.a.useState(!1),f=Object(u.a)(_,2),h=f[0],v=f[1],C=i.a.useState(""),k=Object(u.a)(C,2),x=k[0],g=k[1];return i.a.useEffect((function(){t&&(m(""),d(!1),v(!1),g(""))}),[t]),Object(n.jsxs)(O,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"AvatarEdit",button:l?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,isValid:h,onClose:a,onSubmit:function(e){e.preventDefault(),d(!0),c({avatar:b})},onClickOverlay:o,children:[Object(n.jsx)("input",{type:"url",name:"avatar",className:"popup__input popup__field_avatar-edit",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",value:b,id:"input-avatar",onChange:function(e){v(e.target.validity.valid),g(e.target.validationMessage),m(e.target.value)},required:!0}),Object(n.jsx)("span",{className:"error ".concat(h?"":"error_active"),id:"input-avatar-error",children:x})]})};var C=function(e){var t=e.isOpen,a=e.onClose,c=e.onAddPlace,o=e.onClickOverlay,s=i.a.useState(!1),r=Object(u.a)(s,2),l=r[0],d=r[1],p=i.a.useState(""),j=Object(u.a)(p,2),b=j[0],m=j[1],_=i.a.useState(""),f=Object(u.a)(_,2),h=f[0],v=f[1],C=i.a.useState(!1),k=Object(u.a)(C,2),x=k[0],g=k[1],y=i.a.useState(""),N=Object(u.a)(y,2),S=N[0],E=N[1],L=i.a.useState(!1),P=Object(u.a)(L,2),U=P[0],D=P[1],q=i.a.useState(""),A=Object(u.a)(q,2),w=A[0],T=A[1];return i.a.useEffect((function(){t&&(m(""),v(""),d(!1),g(!1),D(!1),E(""),T(""))}),[t]),Object(n.jsxs)(O,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"ElementCard",button:l?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",onSubmit:function(e){e.preventDefault(),d(!0),c({name:b,link:h})},isOpen:t,isValid:U&&x,onClose:a,onClickOverlay:o,children:[Object(n.jsx)("input",{type:"text",name:"title",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__input popup__field-title",id:"input-title",minLength:"2",maxLength:"30",value:b,onChange:function(e){g(e.target.validity.valid),E(e.target.validationMessage),m(e.target.value)},required:!0}),Object(n.jsx)("span",{className:"error ".concat(x?"":"error_active"),id:"input-title-error",children:S}),Object(n.jsx)("input",{type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input popup__field-link",id:"input-link",value:h,onChange:function(e){D(e.target.validity.valid),T(e.target.validationMessage),v(e.target.value)},required:!0}),Object(n.jsx)("span",{className:"error ".concat(U?"":"error_active"),id:"input-link-error",children:w})]})};var k=function(e){var t=e.isOpen,a=e.onClose,c=e.onDeleteCard,o=e.onClickOverlay,s=i.a.useState(!1),r=Object(u.a)(s,2),l=r[0],d=r[1];return i.a.useEffect((function(){t&&d(!1)}),[t]),Object(n.jsx)(O,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"ElementDeleteImage",button:l?"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435...":"\u0414\u0430",isOpen:t,onClose:a,isValid:!0,onSubmit:function(e){e.preventDefault(),d(!0),c()},onClickOverlay:o})},x=a(8),g=a(9),y=new(function(){function e(t){Object(x.a)(this,e),this._url=t.baseUrl,this._headers=t.headers}return Object(g.a)(e,[{key:"_fetchRequest",value:function(e,t){return fetch("".concat(this._url).concat(e),t).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"getUserInfo",value:function(){return this._fetchRequest("users/me",{headers:this._headers})}},{key:"getInitialCards",value:function(){return this._fetchRequest("cards",{headers:this._headers})}},{key:"updateUserInfo",value:function(e){return this._fetchRequest("users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})})}},{key:"addNewCard",value:function(e){return this._fetchRequest("cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})})}},{key:"changeLikeCardStatus",value:function(e,t){return this._fetchRequest("cards/likes/".concat(e),{method:t?"DELETE":"PUT",headers:this._headers})}},{key:"deleteCard",value:function(e){return this._fetchRequest("cards/".concat(e),{method:"DELETE",headers:this._headers})}},{key:"updateUserAvatar",value:function(e){return this._fetchRequest("users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})})}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-18/",headers:{authorization:"f1223aac-5b35-40a7-86dd-5f21c8954485","Content-Type":"application/json"}});var N=function(){var e=i.a.useState(!1),t=Object(u.a)(e,2),a=t[0],c=t[1],o=i.a.useState(!1),s=Object(u.a)(o,2),d=s[0],b=s[1],O=i.a.useState(!1),x=Object(u.a)(O,2),g=x[0],N=x[1],S=i.a.useState(!1),E=Object(u.a)(S,2),L=E[0],P=E[1],U=i.a.useState({isOpen:!1,link:"",name:""}),D=Object(u.a)(U,2),q=D[0],A=D[1],w=i.a.useState({}),T=Object(u.a)(w,2),I=T[0],R=T[1],M=i.a.useState([]),V=Object(u.a)(M,2),J=V[0],F=V[1],B=i.a.useState({}),H=Object(u.a)(B,2),z=H[0],G=H[1];function K(){N(!1),b(!1),c(!1),P(!1),A({isOpen:!1,link:"",name:""}),document.removeEventListener("keydown",W)}function Q(e){e.target.classList.contains("popup_opened")&&K()}function W(e){"Escape"===e.key&&K()}return i.a.useEffect((function(){Promise.all([y.getUserInfo(),y.getInitialCards()]).then((function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];R(a),F(n)})).catch((function(e){return console.log("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e))}))}),[]),Object(n.jsx)(j.Provider,{value:I,children:Object(n.jsxs)("div",{className:"page",children:[Object(n.jsx)(p,{}),Object(n.jsx)(m,{onEditProfile:function(){b(!d),document.addEventListener("keydown",W)},onAddPlace:function(){N(!g),document.addEventListener("keydown",W)},onEditAvatar:function(){c(!a)},onCardClick:function(e){var t=e.link,a=e.name;A({isOpen:!0,link:t,name:a}),document.addEventListener("keydown",W)},cards:J,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===I._id}));y.changeLikeCardStatus(e._id,t).then((function(t){var a=J.map((function(a){return a._id===e._id?t:a}));F(a)})).catch((function(e){return console.log("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e))}))},onCardDelete:function(e){P(!L),G(e),document.addEventListener("keydown",W)}}),Object(n.jsx)(_,{}),Object(n.jsx)(k,{isOpen:L,onClose:K,onDeleteCard:function(){y.deleteCard(z._id).then((function(){var e=J.filter((function(e){return e._id!==z._id}));F(e),G({}),K()})).catch((function(e){return console.log("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e))}))},onClickOverlay:Q}),Object(n.jsx)(v,{isOpen:a,onClose:K,onUpdateAvatar:function(e){y.updateUserAvatar(e).then((function(){R(Object(l.a)(Object(l.a)({},I),e)),K()})).catch((function(e){return console.log("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e))}))},onClickOverlay:Q}),Object(n.jsx)(h,{isOpen:d,onClose:K,onUpdateUser:function(e){y.updateUserInfo(e).then((function(){R(Object(l.a)(Object(l.a)({},I),e)),K()})).catch((function(e){return console.log("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e))}))},onClickOverlay:Q}),Object(n.jsx)(C,{isOpen:g,onClose:K,onAddPlace:function(e){y.addNewCard(e).then((function(e){F([e].concat(Object(r.a)(J))),K()})).catch((function(e){return console.log("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e))}))},onClickOverlay:Q}),Object(n.jsx)(f,{card:q,onClose:K,onClickOverlay:Q})]})})},S=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,18)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;a(e),n(e),c(e),i(e),o(e)}))};s.a.render(Object(n.jsx)(i.a.StrictMode,{children:Object(n.jsx)(N,{})}),document.getElementById("root")),S()}},[[17,1,2]]]);
//# sourceMappingURL=main.cf5a50b3.chunk.js.map